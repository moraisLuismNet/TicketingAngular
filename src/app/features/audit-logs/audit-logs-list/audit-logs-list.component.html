<div class="audit-logs-container">
  <div class="header-section">
    <h1>Audit Logs</h1>
    <p>Traceability and change history</p>
  </div>

  <div class="card">
    @if (isLoading) {
      <div class="loading-state">
        <div class="spinner"></div>
        <p>Loading audit logs...</p>
      </div>
    } @else if (auditLogs.length === 0) {
      <div class="empty-state">
        <p>No audit logs found.</p>
      </div>
    } @else {
      <div class="table-responsive">
        <table class="audit-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Entity</th>
              <th>Action</th>
              <th>Record ID</th>
              <th>User</th>
              <th>Details</th>
            </tr>
          </thead>
          <tbody>
            @for (log of paginatedLogs; track log.id) {
              <tr>
                <td>{{ formatDate(log.createdAt) }}</td>
                <td><span class="badge entity-badge">{{ log.entityName }}</span></td>
                <td>
                  <span class="badge action-badge" [ngClass]="log.action.toLowerCase()">
                    {{ log.action }}
                  </span>
                </td>
                <td>#{{ log.recordId }}</td>
                <td>{{ log.userName }}</td>
                <td class="values-cell">
                  @if (log.oldValues || log.newValues) {
                    <div class="values-summary">
                      <details>
                        <summary>View Changes</summary>
                        <div class="values-diff">
                          @if (log.oldValues) {
                            <div class="old-values">
                              <strong>Old:</strong>
                              <pre>{{ log.oldValues }}</pre>
                            </div>
                          }
                          @if (log.newValues) {
                            <div class="new-values">
                              <strong>New:</strong>
                              <pre>{{ log.newValues }}</pre>
                            </div>
                          }
                        </div>
                      </details>
                    </div>
                  } @else {
                    <span>-</span>
                  }
                </td>
              </tr>
            }
          </tbody>
        </table>

        <app-pagination
          [totalItems]="auditLogs.length"
          [pageSize]="pageSize"
          [currentPage]="currentPage"
          (pageChange)="onPageChange($event)">
        </app-pagination>
      </div>
    }
  </div>
</div>
